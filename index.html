<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>SunriseRP – Adminpanel</title>
<style>
/* ----------------- GLOBAL ----------------- */
body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  color: #fff;
  background: url('sunriserp.png') center/cover fixed no-repeat;
}
header {
  background: rgba(0,0,0,0.6);
  text-align: center;
  padding: 20px;
  font-size: 24px;
  letter-spacing: 2px;
  text-shadow: 0 0 10px #ffbb55;
}
nav {
  text-align: center;
  background: rgba(0,0,0,0.4);
  padding: 10px;
}
nav button {
  background: rgba(255,255,255,0.15);
  border: none;
  color: #fff;
  padding: 10px 20px;
  margin: 5px;
  border-radius: 5px;
  cursor: pointer;
  transition: 0.3s;
}
nav button:hover {
  background: rgba(255,200,120,0.4);
}

section {
  display: none;
  padding: 20px;
  margin: 20px auto;
  max-width: 1000px;
  background: rgba(0,0,0,0.55);
  border-radius: 10px;
}
section.active { display: block; }

h2, h3 {
  text-align: center;
  color: #ffbb55;
  text-shadow: 0 0 10px #ffbb55;
}

table {
  width: 100%;
  border-collapse: collapse;
  color: #fff;
}
th, td {
  border: 1px solid rgba(255,255,255,0.3);
  padding: 8px;
  text-align: center;
}

input, select, textarea, button {
  padding: 8px;
  border: none;
  border-radius: 4px;
  margin: 5px 0;
  font-family: inherit;
}

textarea { width: 95%; min-height: 60px; }
.avatar { border-radius: 50%; width: 50px; }

.save-btn, .login-form button {
  background: #ffbb55;
  color: #000;
  cursor: pointer;
}
.save-btn:hover, .login-form button:hover { background: #ffd480; }

form > div { margin-bottom: 10px; }

/* Popup Styling */
.popup {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.7);
  display: flex; justify-content: center; align-items: center;
  visibility: hidden; opacity: 0;
  transition: 0.3s;
}
.popup.active { visibility: visible; opacity: 1; }
.popup-content {
  background: #222;
  padding: 20px;
  border-radius: 10px;
  text-align: left;
  width: 300px;
}
.popup-content h3 { margin-top: 0; text-align: center; }
.popup-content button { width: 100%; margin-top: 10px; }
</style>
</head>
<body>

<header>☀️ Sunrise Roleplay – Minecraft RP auf höchstem Niveau</header>

<nav>
  <button onclick="showSection('regelwerk')">Regelwerk</button>
  <button onclick="showSection('team')">Team</button>
  <button onclick="showSection('bewerbung')">Bewerbung</button>
  <button onclick="showSection('entbannung')">Entbannungsantrag</button>
  <button onclick="showSection('panel')">Admin Panel</button>
</nav>

<section id="regelwerk" class="active">
  <h2>Regelwerk SunriseRP</h2>
  <pre style="white-space: pre-wrap; font-family: inherit;">
- OOC Talk verboten
- RDM/VDM verboten
- Fail RP vermeiden
- Diskriminierung verboten
- Alles IC
- Deutsch & Mikrofon
- Keine Zweitaccounts
- Bestechung verboten
- Unrealistische Wörter verboten
- Nur eigener Minecraft Account
- AFK rumstehen verboten
- Bugusing/Hacks verboten
- Support nicht ausnutzen
- Item-Erstattung nur mit Inventar sichtbar & Clip
- Realistisches Rauben
- Max 2 Räube/Tag
- Max 1500€ pro Geisel
- Ganggebiet = sofortiger Beschuss
- Waffen realistisch nutzen
- Servergespräche nicht im RP

Bei Fragen könnt ihr euch gerne im Support-Warteraum auf unserem Discord einfinden. LG Fabian (:
  </pre>
</section>

<section id="team">
  <h2>Teammitglieder</h2>
  <table class="team-table">
    <thead>
      <tr><th>Avatar</th><th>Name</th><th>Rolle</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section id="bewerbung">
  <h2>Bewerbung einreichen</h2>
  <form class="bewerbung-form">
    <select class="bewerbungs-art" required>
      <option value="Fraktionsbewerbung">Fraktionsbewerbung</option>
      <option value="Teambewerbung">Teambewerbung</option>
    </select>
    <div class="team-positionen" style="display:none;">
      <select class="bewerbung-position">
        <option value="Developer">Developer</option>
        <option value="Supporter">Supporter</option>
        <option value="Builder">Builder</option>
        <option value="Designer">Designer</option>
        <option value="Content Creator">Content Creator</option>
      </select>
    </div>
    <input type="text" class="bewerbung-discord" placeholder="Discord Name" required>
    <input type="text" class="bewerbung-minecraft" placeholder="Minecraft Name" required>
    <input type="email" class="bewerbung-email" placeholder="E-Mail" required>
    <textarea class="bewerbung-text" placeholder="Bewerbungstext" required></textarea>
    <button type="submit">Absenden</button>
  </form>
</section>

<section id="entbannung">
  <h2>Entbannungsantrag</h2>
  <form class="entbannung-form">
    <input type="text" class="entbannung-minecraft" placeholder="Minecraft Name" required>
    <input type="email" class="entbannung-email" placeholder="E-Mail" required>
    <textarea class="entbannung-text" placeholder="Begründung" required></textarea>
    <button type="submit">Absenden</button>
  </form>
</section>

<section id="panel">
  <h2>Admin Panel</h2>
  <form class="login-form">
    <input type="text" class="login-user" placeholder="Benutzername" required>
    <input type="password" class="login-pass" placeholder="Passwort" required>
    <button type="submit">Login</button>
  </form>

  <div class="panel-content" style="display:none;">
    <div class="panel-section bewerbungen-section">
      <h3>Bewerbungen</h3>
      <button onclick="bulkBewerbungenSeen()">Alle offen auf 'gesehen'</button>
      <table class="panel-bewerbungen"><thead>
        <tr><th>Datum</th><th>Art</th><th>Discord</th><th>Minecraft</th><th>Email</th><th>Position</th><th>Text</th><th>Notiz</th><th>Status</th><th>Bearbeitet von</th><th>Aktion</th></tr>
      </thead><tbody></tbody></table>
    </div>

    <div class="panel-section entbannungen-section">
      <h3>Entbannungsanträge</h3>
      <table class="panel-entbannungen"><thead>
        <tr><th>Datum</th><th>Minecraft</th><th>Email</th><th>Text</th><th>Notiz</th><th>Status</th><th>Bearbeitet von</th><th>Aktion</th></tr>
      </thead><tbody></tbody></table>
    </div>

    <div class="panel-section team-section">
      <h3>Teamverwaltung</h3>
      <form class="team-create-form">
        <input type="text" class="team-name" placeholder="Name" required>
        <input type="text" class="team-role" placeholder="Rolle" required>
        <input type="password" class="team-pass" placeholder="Passwort" required>
        <input type="file" class="team-avatar" accept="image/*">
        <img id="avatar-preview" src="sunriserp.png" class="avatar">
        <button type="submit">Teamaccount erstellen</button>
      </form>
      <table class="team-accounts-table">
        <thead><tr><th>Name</th><th>Rolle</th><th>Avatar</th><th>Aktion</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</section>

<div class="popup" id="permPopup">
  <div class="popup-content">
    <h3>Berechtigungen bearbeiten</h3>
    <label><input type="checkbox" id="permApps"> Bewerbungen bearbeiten</label><br>
    <label><input type="checkbox" id="permBans"> Entbannungen bearbeiten</label><br>
    <label><input type="checkbox" id="permTeam"> Team verwalten</label><br>
    <button onclick="savePermissions()">Speichern</button>
    <button onclick="closePopup()">Schließen</button>
  </div>
</div>

<script>
// ----------------- DATEN -----------------
let teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || [];
let bewerbungen = JSON.parse(localStorage.getItem('bewerbungen')) || [];
let entbannungen = JSON.parse(localStorage.getItem('entbannungen')) || [];
let currentUser = null;
let editTarget = null;

// ----------------- FACTORY -----------------
const createTeamMember = (name, role, pass, avatar='sunriserp.png', permissions=null) => {
  if(!permissions){
    permissions = (role === 'Leitung')
      ? {editApplications:true, editBans:true, deleteTeam:true}
      : {editApplications:false, editBans:false, deleteTeam:false};
  }
  return {name, role, pass, avatar, permissions};
};

// Standard-Leitungskonto
if(!teamMembers.find(m => m.name === 'Leitung')){
  teamMembers.unshift(createTeamMember('Leitung','Leitung','Leitung123'));
  saveData();
}

// ----------------- NAVIGATION -----------------
function showSection(id){
  document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function saveData(){
  localStorage.setItem('teamMembers',JSON.stringify(teamMembers));
  localStorage.setItem('bewerbungen',JSON.stringify(bewerbungen));
  localStorage.setItem('entbannungen',JSON.stringify(entbannungen));
  renderTeam(); renderPanel();
}

// ----------------- PANEL LOGIC -----------------
document.querySelector('.login-form').onsubmit = e=>{
  e.preventDefault();
  const user = document.querySelector('.login-user').value;
  const pass = document.querySelector('.login-pass').value;
  const acc = teamMembers.find(m => m.name===user && m.pass===pass);
  if(!acc) return alert('Login fehlgeschlagen!');
  currentUser = acc;
  alert(`Willkommen, ${acc.name}!`);
  document.querySelector('.panel-content').style.display='block';
  togglePanelVisibility();
  renderPanel();
};

function togglePanelVisibility(){
  document.querySelector('.bewerbungen-section').style.display = currentUser.permissions.editApplications ? 'block' : 'none';
  document.querySelector('.entbannungen-section').style.display = currentUser.permissions.editBans ? 'block' : 'none';
  document.querySelector('.team-section').style.display = currentUser.permissions.deleteTeam ? 'block' : 'none';
}

// ----------------- POPUP -----------------
function openPermPopup(name){
  if(currentUser?.role !== 'Leitung') return alert('Nur Leitung darf Berechtigungen ändern!');
  editTarget = teamMembers.find(m=>m.name===name);
  if(!editTarget) return;
  document.getElementById('permApps').checked = editTarget.permissions.editApplications;
  document.getElementById('permBans').checked = editTarget.permissions.editBans;
  document.getElementById('permTeam').checked = editTarget.permissions.deleteTeam;
  document.getElementById('permPopup').classList.add('active');
}
function closePopup(){ document.getElementById('permPopup').classList.remove('active'); }
function savePermissions(){
  editTarget.permissions.editApplications = document.getElementById('permApps').checked;
  editTarget.permissions.editBans = document.getElementById('permBans').checked;
  editTarget.permissions.deleteTeam = document.getElementById('permTeam').checked;
  saveData(); closePopup();
}

// ----------------- RENDER -----------------
function renderTeam(){
  const tbody = document.querySelector('.team-table tbody');
  tbody.innerHTML = teamMembers.map(m =>
    `<tr><td><img src="${m.avatar}" class="avatar"></td><td>${m.name}</td><td>${m.role}</td></tr>`
  ).join('');
}
function renderPanel(){
  const tbodyT = document.querySelector('.team-accounts-table tbody');
  tbodyT.innerHTML = teamMembers.map(m=>{
    let buttons = '';
    if(currentUser?.role==='Leitung' && m.name!=='Leitung')
      buttons = `<button onclick="openPermPopup('${m.name}')">Berechtigungen</button> <button onclick="deleteTeam('${m.name}')">Löschen</button>`;
    return `<tr><td>${m.name}</td><td>${m.role}</td><td><img src="${m.avatar}" class="avatar"></td><td>${buttons}</td></tr>`;
  }).join('');
}

// ----------------- TEAM CREATION -----------------
document.querySelector('.team-create-form').onsubmit = e=>{
  e.preventDefault();
  if(currentUser?.role!=='Leitung') return alert('Nur Leitung darf Teamaccounts erstellen!');
  const name = document.querySelector('.team-name').value;
  const role = document.querySelector('.team-role').value;
  const pass = document.querySelector('.team-pass').value;
  const avatarFile = document.querySelector('.team-avatar').files[0];
  const reader = new FileReader();
  reader.onload = ()=>{ teamMembers.push(createTeamMember(name,role,pass,reader.result)); saveData(); e.target.reset(); };
  if(avatarFile) reader.readAsDataURL(avatarFile); else { teamMembers.push(createTeamMember(name,role,pass)); saveData(); e.target.reset(); }
};

// ----------------- PANEL ACTIONS -----------------
function deleteTeam(name){
  if(currentUser?.role!=='Leitung') return alert('Nur Leitung darf löschen!');
  if(confirm(`Teammitglied ${name} löschen?`)){
    teamMembers = teamMembers.filter(m=>m.name!==name);
    saveData();
  }
}

// ----------------- INIT -----------------
renderTeam();
renderPanel();
</script>

</body>
</html>
