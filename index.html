<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>SunriseRP â€“ Adminpanel</title>
<style>
  body { font-family: 'Poppins', sans-serif; margin: 0; color: #fff; background: url('sunriserp.png') center/cover fixed no-repeat; }
  header { background: rgba(0,0,0,0.6); text-align: center; padding: 20px; font-size: 24px; letter-spacing: 2px; text-shadow: 0 0 10px #ffbb55; }
  nav { text-align: center; background: rgba(0,0,0,0.4); padding: 10px; }
  nav button { background: rgba(255,255,255,0.15); border: none; color: #fff; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer; transition: 0.3s; }
  nav button:hover { background: rgba(255,200,120,0.4); }
  section { display: none; padding: 20px; margin: 20px auto; max-width: 1000px; background: rgba(0,0,0,0.55); border-radius: 10px; }
  section.active { display: block; }
  h2, h3 { text-align: center; color: #ffbb55; text-shadow: 0 0 10px #ffbb55; }
  table { width: 100%; border-collapse: collapse; color: #fff; }
  th, td { border: 1px solid rgba(255,255,255,0.3); padding: 8px; text-align: center; }
  input, select, textarea, button { padding: 8px; border: none; border-radius: 4px; margin: 5px 0; font-family: inherit; }
  textarea { width: 95%; min-height: 60px; }
  .avatar { border-radius: 50%; width: 50px; }
  .save-btn, .login-form button { background: #ffbb55; color: #000; cursor: pointer; }
  .save-btn:hover, .login-form button:hover { background: #ffd480; }
  form > div { margin-bottom: 10px; }
</style>
</head>
<body>

<header>ðŸŒ… Sunrise Roleplay â€“ Minecraft RP auf hÃ¶chstem Niveau</header>

<nav>
  <button onclick="showSection('regelwerk')">Regelwerk</button>
  <button onclick="showSection('team')">Team</button>
  <button onclick="showSection('bewerbung')">Bewerbung</button>
  <button onclick="showSection('entbannung')">Entbannungsantrag</button>
  <button onclick="showSection('panel')">Admin Panel</button>
</nav>

<section id="regelwerk" class="active">
  <h2>Regelwerk SunriseRP</h2>
  <pre style="white-space: pre-wrap; font-family: inherit;">
- OOC Talk verboten
- RDM/VDM verboten
- Fail RP vermeiden
- Diskriminierung verboten
- Alles IC
- Deutsch & Mikrofon
- Keine Zweitaccounts
- Bestechung verboten
- Unrealistische WÃ¶rter verboten
- Nur eigener Minecraft Account
- AFK rumstehen verboten
- Bugusing/Hacks verboten
- Support nicht ausnutzen
- Item-Erstattung nur mit Inventar sichtbar & Clip
- Realistisches Rauben
- Max 2 RÃ¤ube/Tag
- Max 1500â‚¬ pro Geisel
- Ganggebiet = sofortiger Beschuss
- Waffen realistisch nutzen
- ServergesprÃ¤che nicht im RP
  </pre>
</section>

<section id="team">
  <h2>Teammitglieder</h2>
  <table class="team-table">
    <thead>
      <tr><th>Avatar</th><th>Name</th><th>Rolle</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section id="bewerbung">
  <h2>Bewerbung einreichen</h2>
  <form class="bewerbung-form">
    <div>
      <select class="bewerbungs-art" required>
        <option value="Fraktionsbewerbung">Fraktionsbewerbung</option>
        <option value="Teambewerbung">Teambewerbung</option>
      </select>
    </div>
    <div class="team-positionen" style="display:none;">
      <select class="bewerbung-position">
        <option value="Developer">Developer</option>
        <option value="Supporter">Supporter</option>
        <option value="Builder">Builder</option>
        <option value="Designer">Designer</option>
        <option value="Content Creator">Content Creator</option>
      </select>
    </div>
    <div><input type="text" class="bewerbung-discord" placeholder="Discord Name" required></div>
    <div><input type="text" class="bewerbung-minecraft" placeholder="Minecraft Name" required></div>
    <div><input type="email" class="bewerbung-email" placeholder="E-Mail" required></div>
    <div><textarea class="bewerbung-text" placeholder="Bewerbungstext" required></textarea></div>
    <button type="submit">Absenden</button>
  </form>
</section>

<section id="entbannung">
  <h2>Entbannungsantrag</h2>
  <form class="entbannung-form">
    <div><input type="text" class="entbannung-minecraft" placeholder="Minecraft Name" required></div>
    <div><input type="email" class="entbannung-email" placeholder="E-Mail" required></div>
    <div><textarea class="entbannung-text" placeholder="BegrÃ¼ndung" required></textarea></div>
    <button type="submit">Absenden</button>
  </form>
</section>

<section id="panel">
  <h2>Admin Panel</h2>
  <form class="login-form">
    <div><input type="text" class="login-user" placeholder="Benutzername" required></div>
    <div><input type="password" class="login-pass" placeholder="Passwort" required></div>
    <button type="submit">Login</button>
    <span class="login-message"></span>
  </form>

  <div class="panel-content" style="display:none;">
    <h3>Bewerbungen</h3>
    <table class="panel-bewerbungen">
      <thead>
        <tr>
          <th>Art</th><th>Discord</th><th>Minecraft</th><th>Email</th>
          <th>Position</th><th>Text</th><th>Notiz</th><th>Status</th><th>Bearbeitet von</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>EntbannungsantrÃ¤ge</h3>
    <table class="panel-entbannungen">
      <thead>
        <tr>
          <th>Minecraft</th><th>Email</th><th>Text</th><th>Notiz</th><th>Status</th><th>Bearbeitet von</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>Teamverwaltung</h3>
    <form class="team-create-form">
      <div><input type="text" class="team-name" placeholder="Name" required></div>
      <div><input type="text" class="team-role" placeholder="Rolle" required></div>
      <div><input type="password" class="team-pass" placeholder="Passwort" required></div>
      <div><input type="file" class="team-avatar" accept="image/*"></div>
      <button type="submit">Teamaccount erstellen</button>
    </form>
    <table class="team-accounts-table">
      <thead>
        <tr><th>Name</th><th>Rolle</th><th>Avatar</th><th>Aktion</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <button class="save-btn">Ã„nderungen speichern</button>
  </div>
</section>

<script>
/* ----------------- DATEN UND KLASSEN IN SCRIPT ----------------- */
let teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || [];
let bewerbungen = JSON.parse(localStorage.getItem('bewerbungen')) || [];
let entbannungen = JSON.parse(localStorage.getItem('entbannungen')) || [];
let currentUser = null;

// TeamMember erstellen
function createTeamMember(name, role, pass, avatar='sunriserp.png', permissions={editApplications:true,editBans:true,assignRoles:true,deleteTeam:true}) {
  return {name, role, pass, avatar, permissions};
}

// Bewerbung erstellen
function createBewerbung(art, discord, minecraft, email, position, text){
  return {art, discord, minecraft, email, position, text, notiz:'', status:'offen', bearbeiter:''};
}

// Entbannung erstellen
function createEntbannung(minecraft, email, text){
  return {minecraft, email, text, notiz:'', status:'offen', bearbeiter:''};
}

// Standard-Admin
if(!teamMembers.find(m=>m.name==='Leitung')){
    teamMembers.unshift(createTeamMember('Leitung','Leitung','Leitung123','sunriserp.png',{
        editApplications:true, editBans:true, assignRoles:true, deleteTeam:true
    }));
    saveData();
}

/* ----------------- NAVIGATION ----------------- */
function showSection(id){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.location.hash=id;
}
window.addEventListener('load', ()=>{ if(window.location.hash) showSection(window.location.hash.substring(1)); });

/* ----------------- RENDER ----------------- */
function renderTeam(){ 
  const tbody=document.querySelector('.team-table tbody'); tbody.innerHTML='';
  teamMembers.forEach(m=>tbody.innerHTML+=`<tr><td><img class="avatar" src="${m.avatar}"></td><td>${m.name}</td><td>${m.role}</td></tr>`);
}

function renderPanel(){
  renderPanelBewerbungen();
  renderPanelEntbannungen();
  renderTeamAccounts();
}

function renderPanelBewerbungen(){
  const tb=document.querySelector('.panel-bewerbungen tbody'); tb.innerHTML='';
  bewerbungen.forEach((b,i)=>{
    tb.innerHTML+=`<tr>
      <td>${b.art}</td><td>${b.discord}</td><td>${b.minecraft}</td><td>${b.email}</td><td>${b.position}</td><td>${b.text}</td>
      <td><textarea id="notiz-${i}">${b.notiz}</textarea></td>
      <td><button onclick="toggleBStatus(${i})">${b.status}</button></td>
      <td>${b.bearbeiter}</td>
    </tr>`;
  });
}

function renderPanelEntbannungen(){
  const tb=document.querySelector('.panel-entbannungen tbody'); tb.innerHTML='';
  entbannungen.forEach((b,i)=>{
    tb.innerHTML+=`<tr>
      <td>${b.minecraft}</td><td>${b.email}</td><td>${b.text}</td>
      <td><textarea id="e-notiz-${i}">${b.notiz}</textarea></td>
      <td><button onclick="toggleEStatus(${i})">${b.status}</button></td>
      <td>${b.bearbeiter}</td>
    </tr>`;
  });
}

function renderTeamAccounts(){
  const tb=document.querySelector('.team-accounts-table tbody'); tb.innerHTML='';
  teamMembers.forEach((m,i)=>{
    tb.innerHTML+=`<tr>
      <td>${m.name}</td><td>${m.role}</td>
      <td><img class="avatar" src="${m.avatar}"></td>
      <td><button onclick="deleteTeam(${i})">LÃ¶schen</button></td>
    </tr>`;
  });
}

/* ----------------- FUNKTIONEN ----------------- */
function saveData(){
  localStorage.setItem('teamMembers', JSON.stringify(teamMembers));
  localStorage.setItem('bewerbungen', JSON.stringify(bewerbungen));
  localStorage.setItem('entbannungen', JSON.stringify(entbannungen));
}

const statusCycle = ['offen','gesehen','angenommen','abgelehnt'];
function toggleBStatus(i){ 
  if(!currentUser?.permissions.editApplications){ alert('Keine Berechtigung'); return; }
  let idx=statusCycle.indexOf(bewerbungen[i].status);
  bewerbungen[i].status=statusCycle[(idx+1)%statusCycle.length];
  bewerbungen[i].bearbeiter=currentUser.name;
  saveData(); renderPanelBewerbungen();
}
function toggleEStatus(i){
  if(!currentUser?.permissions.editBans){ alert('Keine Berechtigung'); return; }
  let idx=statusCycle.indexOf(entbannungen[i].status);
  entbannungen[i].status=statusCycle[(idx+1)%statusCycle.length];
  entbannungen[i].bearbeiter=currentUser.name;
  saveData(); renderPanelEntbannungen();
}
function deleteTeam(i){
  if(!currentUser?.permissions.deleteTeam){ alert('Keine Berechtigung'); return; }
  if(confirm('Wirklich lÃ¶schen?')){ teamMembers.splice(i,1); saveData(); renderTeamAccounts(); renderTeam(); }
}

/* ----------------- FORM HANDLER ----------------- */
document.querySelector('.bewerbung-form').addEventListener('submit', e=>{
  e.preventDefault();
  let art = document.querySelector('.bewerbungs-art').value;
  let discord=document.querySelector('.bewerbung-discord').value;
  let minecraft=document.querySelector('.bewerbung-minecraft').value;
  let email=document.querySelector('.bewerbung-email').value;
  let position= document.querySelector('.bewerbung-position')?.value || '';
  let text=document.querySelector('.bewerbung-text').value;
  bewerbungen.push(createBewerbung(art,discord,minecraft,email,position,text));
  saveData(); alert('Bewerbung eingereicht!'); e.target.reset();
});
document.querySelector('.entbannung-form').addEventListener('submit', e=>{
  e.preventDefault();
  let minecraft=document.querySelector('.entbannung-minecraft').value;
  let email=document.querySelector('.entbannung-email').value;
  let text=document.querySelector('.entbannung-text').value;
  entbannungen.push(createEntbannung(minecraft,email,text));
  saveData(); alert('Entbannungsantrag eingereicht!'); e.target.reset();
});
document.querySelector('.login-form').addEventListener('submit', e=>{
  e.preventDefault();
  let user=document.querySelector('.login-user').value;
  let pass=document.querySelector('.login-pass').value;
  let member=teamMembers.find(m=>m.name===user && m.pass===pass);
  const msg=document.querySelector('.login-message');
  if(member){ currentUser=member; document.querySelector('.panel-content').style.display='block'; msg.textContent=''; renderPanel(); } 
  else{ msg.textContent='Login fehlgeschlagen'; msg.style.color='red'; }
});
document.querySelector('.team-create-form').addEventListener('submit', e=>{
  e.preventDefault();
  if(!currentUser?.permissions.assignRoles){ alert('Keine Berechtigung'); return; }
  let name=document.querySelector('.team-name').value;
  let role=document.querySelector('.team-role').value;
  let pass=document.querySelector('.team-pass').value;
  let avatar='sunriserp.png';
  let file=document.querySelector('.team-avatar').files[0];
  if(file){ let reader=new FileReader(); reader.onload=()=>{ teamMembers.push(createTeamMember(name,role,pass,reader.result)); saveData(); renderTeamAccounts(); renderTeam(); e.target.reset(); }; reader.readAsDataURL(file); }
  else{ teamMembers.push(createTeamMember(name,role,pass)); saveData(); renderTeamAccounts(); renderTeam(); e.target.reset(); }
});

/* ----------------- DYNAMISCHE FORM ANPASSUNG ----------------- */
document.querySelector('.bewerbungs-art').addEventListener('change', e=>{
  document.querySelector('.team-positionen').style.display = e.target.value==='Teambewerbung'?'block':'none';
});

/* ----------------- INITIAL RENDER ----------------- */
renderTeam();
</script>

</body>
</html>
