<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SunriseRP – Adminpanel</title>
<style>
body { font-family: 'Poppins', sans-serif; margin: 0; color: #fff; background: url('sunriserp.png') center/cover fixed no-repeat; }
header { background: rgba(0,0,0,0.6); text-align: center; padding: 20px; font-size: 24px; letter-spacing: 2px; text-shadow: 0 0 10px #ffbb55; }
nav { text-align: center; background: rgba(0,0,0,0.4); padding: 10px; }
nav button { background: rgba(255,255,255,0.15); border: none; color: #fff; padding: 10px 20px; margin: 5px; border-radius: 5px; cursor: pointer; transition: 0.3s; }
nav button:hover { background: rgba(255,200,120,0.4); }
section { display: none; padding: 20px; margin: 20px auto; max-width: 1000px; background: rgba(0,0,0,0.55); border-radius: 10px; }
section.active { display: block; }
h2, h3 { text-align: center; color: #ffbb55; text-shadow: 0 0 10px #ffbb55; }
table { width: 100%; border-collapse: collapse; color: #fff; }
th, td { border: 1px solid rgba(255,255,255,0.3); padding: 8px; text-align: center; }
input, select, textarea, button { padding: 8px; border: none; border-radius: 4px; margin: 5px 0; font-family: inherit; }
textarea { width: 95%; min-height: 60px; }
.avatar { border-radius: 50%; width: 50px; height: 50px; object-fit: cover; }
.save-btn, .login-form button { background: #ffbb55; color: #000; cursor: pointer; }
.save-btn:hover, .login-form button:hover { background: #ffd480; }
button.action-btn { background: #ffbb55; color: #000; border-radius: 4px; padding: 6px 12px; cursor: pointer; transition: 0.3s; }
button.action-btn:hover { background: #ffd480; }
.status-select { padding:4px; border-radius:4px; }
.notiz-input { width:90%; padding:4px; border-radius:4px; }
.modal { display:none; position:fixed; z-index:1000; left:0;top:0;width:100%;height:100%; background: rgba(0,0,0,0.8); justify-content:center; align-items:center; }
.modal-content { background: rgba(0,0,0,0.9); padding:20px; border-radius:10px; width:400px; color:#fff; }
.modal-content h3 { margin-top:0; text-align:center; }
.modal-content label { display:block; margin:5px 0; }
.close-modal { cursor:pointer; color:#ffbb55; float:right; font-weight:bold; }
</style>
</head>
<body>

<header>☀️ Sunrise Roleplay – Minecraft RP auf hohem Niveau</header>
<nav>
    <button onclick="showSection('regelwerk')">Regelwerk</button>
    <button onclick="showSection('news')">News</button>
    <button onclick="showSection('team')">Team</button>
    <button onclick="showSection('bewerbung')">Bewerben</button>
    <button onclick="showSection('entbannung')">Entbannung</button>
    <button onclick="showSection('panel')">Admin Panel</button>
</nav>

<!-- Regelwerk -->
<section id="regelwerk" class="active">
<h2>Regelwerk SunriseRP</h2>
<pre style="white-space: pre-wrap; font-family: inherit;">Dein Regelwerk</pre>
</section>

<!-- News -->
<section id="news">
<h2>News</h2>
<div id="news-list"></div>
</section>

<!-- Team -->
<section id="team">
<h2>Teammitglieder</h2>
<table class="team-table">
<thead><tr><th>Avatar</th><th>Name</th><th>Rolle</th></tr></thead>
<tbody></tbody>
</table>
</section>

<!-- Bewerbung -->
<section id="bewerbung">
<h2>Bewerbung einreichen</h2>
<form class="bewerbung-form">
<select class="bewerbungs-art" onchange="togglePositionField()">
<option value="Firmenbewerbung">Firmenbewerbung</option>
<option value="Teambewerbung">Teambewerbung</option>
</select>
<div class="team-positionen" style="display:none;">
<select class="bewerbung-position" required>
<option value="Supporter">Test Supporter</option>
<option value="Builder">Test Builder</option>
<option value="Developer">Test Developer</option>
<option value="Designer">Test Designer</option>
<option value="Content Creator">Test Content Creator</option>
</select>
</div>
<input type="text" class="bewerbung-discord" placeholder="Discord Name" required>
<input type="text" class="bewerbung-minecraft" placeholder="Minecraft Name" required>
<input type="email" class="bewerbung-email" placeholder="E-Mail" required>
<textarea class="bewerbung-text" placeholder="Warum bewirbst du dich?" required></textarea>
<button type="submit">Absenden</button>
</form>
</section>

<!-- Entbannung -->
<section id="entbannung">
<h2>Entbannungsantrag</h2>
<form class="entbannung-form">
<input type="text" class="entbannung-minecraft" placeholder="Minecraft Name" required>
<input type="text" class="entbannung-discord" placeholder="Discord Name" required>
<input type="email" class="entbannung-email" placeholder="E-Mail" required>
<label><input type="checkbox" class="entbannung-discordban"> Discord Bann?</label>
<textarea class="entbannung-text" placeholder="Warum möchtest du entbannt werden?" required></textarea>
<button type="submit">Absenden</button>
</form>
</section>

<!-- Admin Panel -->
<section id="panel">
<h2>Admin Panel</h2>
<form class="login-form">
<input type="text" class="login-user" placeholder="Benutzername" required>
<input type="password" class="login-pass" placeholder="Passwort" required>
<button type="submit">Login</button>
</form>

<div class="panel-content" style="display:none;">
<h3>News erstellen</h3>
<form class="news-form">
<input type="text" class="news-title" placeholder="Titel" required>
<input type="file" class="news-img" accept="image/*">
<textarea class="news-text" placeholder="Text" required></textarea>
<button type="submit">News erstellen</button>
</form>

<h3>Teamverwaltung</h3>
<form class="team-create-form">
<input type="text" class="team-name" placeholder="Name" required>
<input type="text" class="team-role" placeholder="Rolle" required>
<input type="password" class="team-pass" placeholder="Passwort" required>
<input type="file" class="team-avatar" accept="image/png">
<img id="avatar-preview" src="sunriserp.png" class="avatar">
<button type="submit">Teamaccount erstellen</button>
</form>

<table class="team-accounts-table">
<thead><tr><th>Name</th><th>Rolle</th><th>Avatar</th><th>Bearbeiten</th></tr></thead>
<tbody></tbody>
</table>
</div>
</section>

<!-- Modal für Team Bearbeiten -->
<div class="modal" id="team-modal">
<div class="modal-content">
<span class="close-modal" onclick="closeModal()">×</span>
<h3>Teammitglied bearbeiten</h3>
<label>Name: <input type="text" id="modal-name"></label>
<label>Rolle: <input type="text" id="modal-role"></label>
<label>Passwort: <input type="text" id="modal-pass"></label>
<label><input type="checkbox" id="perm-bans"> Entbannungsanträge bearbeiten</label>
<label><input type="checkbox" id="perm-teamapps"> Team-Bewerbungen bearbeiten</label>
<label><input type="checkbox" id="perm-fraktionapps"> Firmen-Bewerbungen bearbeiten</label>
<label><input type="checkbox" id="perm-news"> News erstellen</label>
<button id="save-team">Speichern</button>
<button id="delete-team">Account löschen</button>
</div>
</div>

<script>
// ================== Daten ==================
let teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || [];
let bewerbungen = JSON.parse(localStorage.getItem('bewerbungen')) || [];
let entbannungen = JSON.parse(localStorage.getItem('entbannungen')) || [];
let news = JSON.parse(localStorage.getItem('news')) || [];
let currentUser = null;
let editingIndex = null;

// Standard Leitung
if(!teamMembers.find(m=>m.name==='Leitung')){
    teamMembers.unshift({
        name:'Leitung',role:'Leitung',pass:'Leitung123',avatar:'sunriserp.png',
        permissions:{bans:true,teamApps:true,fraktionApps:true,news:true,teamAccounts:true}
    });
    localStorage.setItem('teamMembers',JSON.stringify(teamMembers));
}

// ================== Navigation ==================
function showSection(id){
    document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

// ================== Bewerbungen ==================
document.querySelector('.bewerbung-form').addEventListener('submit', e=>{
    e.preventDefault();
    const art=document.querySelector('.bewerbungs-art').value;
    const discord=document.querySelector('.bewerbung-discord').value;
    const minecraft=document.querySelector('.bewerbung-minecraft').value;
    const email=document.querySelector('.bewerbung-email').value;
    const pos=document.querySelector('.bewerbung-position')?.value||'';
    const text=document.querySelector('.bewerbung-text').value;
    bewerbungen.push({datum:new Date().toLocaleString(),art,discord,minecraft,email,position:pos,text,status:'offen',notiz:'',bearbeiter:''});
    localStorage.setItem('bewerbungen',JSON.stringify(bewerbungen));
    e.target.reset();
    alert('Bewerbung abgeschickt!');
});

// ================== Entbannung ==================
document.querySelector('.entbannung-form').addEventListener('submit', e=>{
    e.preventDefault();
    const minecraft=document.querySelector('.entbannung-minecraft').value;
    const discord=document.querySelector('.entbannung-discord').value;
    const email=document.querySelector('.entbannung-email').value;
    const discordban=document.querySelector('.entbannung-discordban').checked;
    const text=document.querySelector('.entbannung-text').value;
    entbannungen.push({datum:new Date().toLocaleString(),minecraft,discord,email,discordban,text,status:'offen',notiz:'',bearbeiter:''});
    localStorage.setItem('entbannungen',JSON.stringify(entbannungen));
    e.target.reset();
    alert('Entbannungsantrag abgeschickt!');
});

// ================== Admin Login ==================
document.querySelector('.login-form').addEventListener('submit', e=>{
    e.preventDefault();
    const user=document.querySelector('.login-user').value;
    const pass=document.querySelector('.login-pass').value;
    const u=teamMembers.find(m=>m.name===user && m.pass===pass);
    if(u){currentUser=u; alert('Erfolgreich eingeloggt!'); document.querySelector('.panel-content').style.display='block'; renderPanel(); renderNews();} 
    else alert('Falscher Benutzername oder Passwort!');
});

// ================== Team erstellen ==================
document.querySelector('.team-create-form').addEventListener('submit', e=>{
    e.preventDefault();
    const name=document.querySelector('.team-name').value;
    const role=document.querySelector('.team-role').value;
    const pass=document.querySelector('.team-pass').value;
    const avatar=document.getElementById('avatar-preview').src;
    teamMembers.push({name,role,pass,avatar,permissions:{bans:false,teamApps:false,fraktionApps:false,news:false,teamAccounts:true}});
    localStorage.setItem('teamMembers',JSON.stringify(teamMembers));
    e.target.reset();
    document.getElementById('avatar-preview').src='sunriserp.png';
    renderPanel();
    renderTeam();
});

// ================== Avatar Vorschau ==================
document.querySelector('.team-avatar').addEventListener('change', e=>{
    const file=e.target.files[0];
    if(file){
        const reader=new FileReader();
        reader.onload=ev=>document.getElementById('avatar-preview').src=ev.target.result;
        reader.readAsDataURL(file);
    }
});

// ================== Panel rendern ==================
function renderPanel(){
    const tbodyT=document.querySelector('.team-accounts-table tbody');
    tbodyT.innerHTML='';
    teamMembers.forEach((m,i)=>{
        const canEdit=currentUser.permissions.teamAccounts || currentUser.role==='Leitung';
        tbodyT.innerHTML+=`<tr>
        <td>${m.name}</td><td>${m.role}</td><td><img src="${m.avatar}" class="avatar"></td>
        <td>${(canEdit && m.name!=='Leitung')?`<button class="action-btn" onclick="openModal(${i})">Bearbeiten</button>`:''}</td>
        </tr>`;
    });
}

// ================== Team rendern ==================
function renderTeam(){
    const tbody=document.querySelector('.team-table tbody');
    tbody.innerHTML='';
    teamMembers.forEach(m=>{
        tbody.innerHTML+=`<tr><td><img src="${m.avatar}" class="avatar"></td><td>${m.name}</td><td>${m.role}</td></tr>`;
    });
}

// ================== Modal ==================
function openModal(i){
    editingIndex=i;
    const m=teamMembers[i];
    document.getElementById('modal-name').value=m.name;
    document.getElementById('modal-role').value=m.role;
    document.getElementById('modal-pass').value=m.pass;
    document.getElementById('perm-bans').checked=m.permissions.bans;
    document.getElementById('perm-teamapps').checked=m.permissions.teamApps;
    document.getElementById('perm-fraktionapps').checked=m.permissions.fraktionApps;
    document.getElementById('perm-news').checked=m.permissions.news;
    document.getElementById('team-modal').style.display='flex';
}
function closeModal(){ document.getElementById('team-modal').style.display='none'; }

// ================== Modal speichern ==================
document.getElementById('save-team').addEventListener('click', ()=>{
    if(editingIndex===null) return;
    const m=teamMembers[editingIndex];
    m.name=document.getElementById('modal-name').value;
    m.role=document.getElementById('modal-role').value;
    m.pass=document.getElementById('modal-pass').value;
    m.permissions.bans=document.getElementById('perm-bans').checked;
    m.permissions.teamApps=document.getElementById('perm-teamapps').checked;
    m.permissions.fraktionApps=document.getElementById('perm-fraktionapps').checked;
    m.permissions.news=document.getElementById('perm-news').checked;
    localStorage.setItem('teamMembers',JSON.stringify(teamMembers));
    renderPanel(); renderTeam(); closeModal();
});

// ================== Modal löschen ==================
document.getElementById('delete-team').addEventListener('click', ()=>{
    if(editingIndex===null) return;
    if(teamMembers[editingIndex].name==='Leitung'){
        alert('Leitung-Account kann nicht gelöscht werden!');
        return;
    }
    if(confirm('Account wirklich löschen?')){
        teamMembers.splice(editingIndex,1);
        localStorage.setItem('teamMembers',JSON.stringify(teamMembers));
        renderPanel(); renderTeam(); closeModal();
    }
});

// ================== News ==================
function renderNews(){
    const container=document.getElementById('news-list');
    container.innerHTML='';
    news.forEach(n=>{
        container.innerHTML+=`
        <div style="border:1px solid rgba(255,255,255,0.3);padding:10px;margin:10px 0;">
            <h3>${n.title}</h3>
            ${n.img ? `<img src="${n.img}" style="max-width:100%;">` : ''}
            <p>${n.text}</p>
        </div>`;
    });
}

document.querySelector('.news-form').addEventListener('submit', e=>{
    e.preventDefault();
    if(!currentUser || !currentUser.permissions.news){ alert('Keine Berechtigung!'); return; }
    const title=document.querySelector('.news-title').value;
    const text=document.querySelector('.news-text').value;
    const file=document.querySelector('.news-img').files[0];
    if(file){
        const reader=new FileReader();
        reader.onload=ev=>{
            news.push({title,text,img:ev.target.result});
            localStorage.setItem('news',JSON.stringify(news));
            renderNews();
        };
        reader.readAsDataURL(file);
    } else {
        news.push({title,text,img:null});
        localStorage.setItem('news',JSON.stringify(news));
        renderNews();
    }
    e.target.reset();
});

// ================== Teambewerbung Feld ==================
function togglePositionField(){
    const val=document.querySelector('.bewerbungs-art').value;
    document.querySelector('.team-positionen').style.display=val==='Teambewerbung'?'block':'none';
}

renderTeam();
renderPanel();
renderNews();
</script>
</body>
</html>
