<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SunriseRP – Adminpanel</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  color: #fff;
  background: url('sunriserp.png') center/cover fixed no-repeat;
}
header {
  background: rgba(0,0,0,0.6);
  text-align: center;
  padding: 20px;
  font-size: 24px;
  text-shadow: 0 0 10px #ffbb55;
}
nav {
  text-align: center;
  background: rgba(0,0,0,0.4);
  padding: 10px;
}
nav button {
  background: rgba(255,255,255,0.15);
  border: none;
  color: #fff;
  padding: 10px 20px;
  margin: 5px;
  border-radius: 5px;
  cursor: pointer;
  transition: 0.3s;
}
nav button:hover { background: rgba(255,200,120,0.4); }

section {
  display: none;
  padding: 20px;
  margin: 20px auto;
  max-width: 1000px;
  background: rgba(0,0,0,0.55);
  border-radius: 10px;
}
section.active { display: block; }

h2, h3 {
  text-align: center;
  color: #ffbb55;
  text-shadow: 0 0 10px #ffbb55;
}

table {
  width: 100%;
  border-collapse: collapse;
  color: #fff;
}
th, td {
  border: 1px solid rgba(255,255,255,0.3);
  padding: 8px;
  text-align: center;
}
input, select, textarea, button {
  padding: 8px;
  border: none;
  border-radius: 4px;
  margin: 5px 0;
  font-family: inherit;
}
textarea { width: 95%; min-height: 60px; }
button.action-btn {
  background: #ffbb55;
  color: #000;
  border-radius: 4px;
  padding: 6px 12px;
  cursor: pointer;
  transition: 0.3s;
}
button.action-btn:hover { background: #ffd480; }

.permission-toggle {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  padding: 10px;
  border-radius: 5px;
  cursor: pointer;
  margin: 5px;
}
.permission-toggle.active {
  background: #4caf50;
}
.permission-toggle.inactive {
  background: #c0392b;
}
</style>
</head>

<body>
<header>☀️ Sunrise Roleplay – Admin Panel</header>
<nav>
  <button onclick="showSection('bewerbung')">Bewerbung</button>
  <button onclick="showSection('entbannung')">Entbannungsantrag</button>
  <button onclick="showSection('panel')">Admin Panel</button>
</nav>

<!-- BEWERBUNG -->
<section id="bewerbung" class="active">
  <h2>Bewerbung einreichen</h2>
  <form id="bewerbungForm">
    <select id="bewerbungsArt" required onchange="toggleTeamPosition()">
      <option value="Fraktionsbewerbung">Fraktionsbewerbung</option>
      <option value="Teambewerbung">Teambewerbung</option>
    </select>
    <div id="teamPositionDiv" style="display:none;">
      <select id="bewerbungPosition" required>
        <option value="Developer">Developer</option>
        <option value="Builder">Builder</option>
        <option value="Supporter">Supporter</option>
        <option value="Designer">Designer</option>
        <option value="Content Creator">Content Creator</option>
      </select>
    </div>
    <input type="text" id="bewerbungDiscord" placeholder="Discord Name" required>
    <input type="text" id="bewerbungMinecraft" placeholder="Minecraft Name" required>
    <input type="email" id="bewerbungEmail" placeholder="E-Mail" required>
    <textarea id="bewerbungText" placeholder="Bewerbungstext" required></textarea>
    <button type="submit">Absenden</button>
  </form>
</section>

<!-- ENTBANNUNGSANTRAG -->
<section id="entbannung">
  <h2>Entbannungsantrag</h2>
  <form id="entbannungForm">
    <input type="text" id="entbannMinecraft" placeholder="Minecraft Name" required>
    <input type="text" id="entbannDiscord" placeholder="Discord Name" required>
    <input type="email" id="entbannEmail" placeholder="E-Mail" required>
    <label><input type="checkbox" id="entbannDiscordBan"> Auch vom Discord gebannt?</label>
    <textarea id="entbannText" placeholder="Begründung" required></textarea>
    <button type="submit">Absenden</button>
  </form>
</section>

<!-- ADMIN PANEL -->
<section id="panel">
  <h2>Admin Panel</h2>
  <form id="loginForm">
    <input type="text" id="loginUser" placeholder="Benutzername" required>
    <input type="password" id="loginPass" placeholder="Passwort" required>
    <button type="submit">Login</button>
  </form>

  <div id="panelContent" style="display:none;">
    <h3>Teammitglieder</h3>
    <table id="teamTable">
      <thead><tr><th>Name</th><th>Rolle</th><th>Aktion</th></tr></thead>
      <tbody></tbody>
    </table>

    <div id="manageView" style="display:none;">
      <h3 id="manageTitle">Berechtigungen verwalten</h3>
      <div id="permissionControls"></div>
      <button onclick="backToPanel()">Zurück</button>
    </div>
  </div>
</section>

<script>
const LEITUNG_PASS = "L3!t@d#SunR1$e2025";
let currentUser = null;
let team = JSON.parse(localStorage.getItem('team')) || [
  {name:"Leitung", role:"Leitung", pass:LEITUNG_PASS, permissions:{teamManage:true, teamApps:true, fracApps:true, bans:true}}
];

function saveTeam(){ localStorage.setItem('team', JSON.stringify(team)); }

function showSection(id){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// Toggle Position
function toggleTeamPosition(){
  document.getElementById("teamPositionDiv").style.display =
    document.getElementById("bewerbungsArt").value === "Teambewerbung" ? "block" : "none";
}

// LOGIN
document.getElementById("loginForm").addEventListener("submit", e=>{
  e.preventDefault();
  const user = document.getElementById("loginUser").value;
  const pass = document.getElementById("loginPass").value;
  const found = team.find(t=>t.name===user && t.pass===pass);
  if(found){
    currentUser = found;
    document.getElementById("loginForm").style.display="none";
    document.getElementById("panelContent").style.display="block";
    renderTeamTable();
  } else {
    alert("Falsche Zugangsdaten!");
  }
});

// TEAM TABELLE
function renderTeamTable(){
  const tbody = document.querySelector("#teamTable tbody");
  tbody.innerHTML="";
  team.forEach((m,i)=>{
    const canManage = currentUser.name==="Leitung" || currentUser.permissions.teamManage;
    const manageBtn = canManage ? `<button class="action-btn" onclick="openManage(${i})">Verwalten</button>` : "—";
    tbody.innerHTML += `<tr><td>${m.name}</td><td>${m.role}</td><td>${manageBtn}</td></tr>`;
  });
}

// VERWALTEN
let selectedIndex=null;
function openManage(i){
  selectedIndex=i;
  document.querySelector("#teamTable").style.display="none";
  document.querySelector("#manageView").style.display="block";
  const m = team[i];
  document.getElementById("manageTitle").innerText = `Berechtigungen von ${m.name}`;
  const perms = [
    {key:"teamManage", label:"Team Accounts verwalten"},
    {key:"teamApps", label:"Teambewerbungen einsehen"},
    {key:"fracApps", label:"Fraktionsbewerbungen einsehen"},
    {key:"bans", label:"Entbannungsanträge einsehen"}
  ];
  const container=document.getElementById("permissionControls");
  container.innerHTML="";
  perms.forEach(p=>{
    const state=m.permissions[p.key];
    container.innerHTML += `
      <div>
        <span>${p.label}</span><br>
        <button class="permission-toggle ${state?'active':'inactive'}" onclick="togglePermission('${p.key}',this)">
          ${state?'Ja':'Nein'}
        </button>
      </div>
    `;
  });
}

function togglePermission(key, btn){
  const m=team[selectedIndex];
  m.permissions[key]=!m.permissions[key];
  btn.classList.toggle('active',m.permissions[key]);
  btn.classList.toggle('inactive',!m.permissions[key]);
  btn.innerText=m.permissions[key]?'Ja':'Nein';
  saveTeam();
}

function backToPanel(){
  document.querySelector("#manageView").style.display="none";
  document.querySelector("#teamTable").style.display="table";
  saveTeam();
  renderTeamTable();
}
</script>
</body>
</html>
