<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>SunriseRP – Adminpanel</title>
<style>
/* ----------------- GLOBAL ----------------- */
body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  color: #fff;
  background: url('sunriserp.png') center/cover fixed no-repeat;
}
header {
  background: rgba(0,0,0,0.6);
  text-align: center;
  padding: 20px;
  font-size: 24px;
  letter-spacing: 2px;
  text-shadow: 0 0 10px #ffbb55;
}
nav {
  text-align: center;
  background: rgba(0,0,0,0.4);
  padding: 10px;
}
nav button {
  background: rgba(255,255,255,0.15);
  border: none;
  color: #fff;
  padding: 10px 20px;
  margin: 5px;
  border-radius: 5px;
  cursor: pointer;
  transition: 0.3s;
}
nav button:hover {
  background: rgba(255,200,120,0.4);
}

section {
  display: none;
  padding: 20px;
  margin: 20px auto;
  max-width: 1000px;
  background: rgba(0,0,0,0.55);
  border-radius: 10px;
}
section.active { display: block; }

h2, h3 {
  text-align: center;
  color: #ffbb55;
  text-shadow: 0 0 10px #ffbb55;
}

table {
  width: 100%;
  border-collapse: collapse;
  color: #fff;
}
th, td {
  border: 1px solid rgba(255,255,255,0.3);
  padding: 8px;
  text-align: center;
}

input, select, textarea, button {
  padding: 8px;
  border: none;
  border-radius: 4px;
  margin: 5px 0;
  font-family: inherit;
}

textarea { width: 95%; min-height: 60px; }
.avatar { border-radius: 50%; width: 50px; }

.save-btn, .login-form button {
  background: #ffbb55;
  color: #000;
  cursor: pointer;
}
.save-btn:hover, .login-form button:hover { background: #ffd480; }

form > div { margin-bottom: 10px; }
</style>
</head>
<body>

<header>☀️ Sunrise Roleplay – Minecraft RP auf höchstem Niveau</header>

<nav>
  <button onclick="showSection('regelwerk')">Regelwerk</button>
  <button onclick="showSection('team')">Team</button>
  <button onclick="showSection('bewerbung')">Bewerbung</button>
  <button onclick="showSection('entbannung')">Entbannungsantrag</button>
  <button onclick="showSection('panel')">Admin Panel</button>
</nav>

<section id="regelwerk" class="active">
  <h2>Regelwerk SunriseRP</h2>
  <pre style="white-space: pre-wrap; font-family: inherit;">
- OOC Talk verboten
- RDM/VDM verboten
- Fail RP vermeiden
- Diskriminierung verboten
- Alles IC
- Deutsch & Mikrofon
- Keine Zweitaccounts
- Bestechung verboten
- Unrealistische Wörter verboten
- Nur eigener Minecraft Account
- AFK rumstehen verboten
- Bugusing/Hacks verboten
- Support nicht ausnutzen
- Item-Erstattung nur mit Inventar sichtbar & Clip
- Realistisches Rauben
- Max 2 Räube/Tag
- Max 1500€ pro Geisel
- Ganggebiet = sofortiger Beschuss
- Waffen realistisch nutzen
- Servergespräche nicht im RP

Bei Fragen könnt ihr euch gerne im Support-Warteraum auf unserem Discord einfinden. LG Fabian (:
  </pre>
</section>

<section id="team">
  <h2>Teammitglieder</h2>
  <table class="team-table">
    <thead>
      <tr><th>Avatar</th><th>Name</th><th>Rolle</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section id="bewerbung">
  <h2>Bewerbung einreichen</h2>
  <input type="text" id="bewerbung-search" placeholder="Bewerbung suchen...">
  <form class="bewerbung-form">
    <div>
      <select class="bewerbungs-art" required>
        <option value="Fraktionsbewerbung">Fraktionsbewerbung</option>
        <option value="Teambewerbung">Teambewerbung</option>
      </select>
    </div>
    <div class="team-positionen" style="display:none;">
      <select class="bewerbung-position">
        <option value="Developer">Developer</option>
        <option value="Supporter">Supporter</option>
        <option value="Builder">Builder</option>
        <option value="Designer">Designer</option>
        <option value="Content Creator">Content Creator</option>
      </select>
    </div>
    <div><input type="text" class="bewerbung-discord" placeholder="Discord Name" required></div>
    <div><input type="text" class="bewerbung-minecraft" placeholder="Minecraft Name" required></div>
    <div><input type="email" class="bewerbung-email" placeholder="E-Mail" required></div>
    <div><textarea class="bewerbung-text" placeholder="Bewerbungstext" required></textarea></div>
    <button type="submit">Absenden</button>
  </form>
</section>

<section id="entbannung">
  <h2>Entbannungsantrag</h2>
  <form class="entbannung-form">
    <div><input type="text" class="entbannung-minecraft" placeholder="Minecraft Name" required></div>
    <div><input type="email" class="entbannung-email" placeholder="E-Mail" required></div>
    <div><textarea class="entbannung-text" placeholder="Begründung" required></textarea></div>
    <button type="submit">Absenden</button>
  </form>
</section>

<section id="panel">
  <h2>Admin Panel</h2>
  <form class="login-form">
    <div><input type="text" class="login-user" placeholder="Benutzername" required></div>
    <div><input type="password" class="login-pass" placeholder="Passwort" required></div>
    <button type="submit">Login</button>
  </form>

  <div class="panel-content" style="display:none;">
    <h3>Bewerbungen</h3>
    <button onclick="bulkBewerbungenSeen()">Alle offen auf 'gesehen'</button>
    <table class="panel-bewerbungen">
      <thead>
        <tr>
          <th>Datum</th><th>Art</th><th>Discord</th><th>Minecraft</th><th>Email</th>
          <th>Position</th><th>Text</th><th>Notiz</th><th>Status</th><th>Bearbeitet von</th><th>Aktion</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>Entbannungsanträge</h3>
    <table class="panel-entbannungen">
      <thead>
        <tr>
          <th>Datum</th><th>Minecraft</th><th>Email</th><th>Text</th><th>Notiz</th><th>Status</th><th>Bearbeitet von</th><th>Aktion</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>Teamverwaltung</h3>
    <form class="team-create-form">
      <div><input type="text" class="team-name" placeholder="Name" required></div>
      <div><input type="text" class="team-role" placeholder="Rolle" required></div>
      <div><input type="password" class="team-pass" placeholder="Passwort" required></div>
      <div><input type="file" class="team-avatar" accept="image/*"></div>
      <div>
        <img id="avatar-preview" src="sunriserp.png" class="avatar">
      </div>
      <div>
        <label><input type="checkbox" class="perm-apps" checked> Bewerbungen bearbeiten</label>
        <label><input type="checkbox" class="perm-bans" checked> Entbannungen bearbeiten</label>
        <label><input type="checkbox" class="perm-team" checked> Team löschen</label>
      </div>
      <button type="submit">Teamaccount erstellen</button>
    </form>
    <table class="team-accounts-table">
      <thead>
        <tr><th>Name</th><th>Rolle</th><th>Avatar</th><th>Aktion</th></tr>
      </thead>
      <tbody></tbody>
    </table>
    <button class="save-btn">Änderungen speichern</button>
  </div>
</section>

<script>
// ----------------- DATEN -----------------
let teamMembers = JSON.parse(localStorage.getItem('teamMembers')) || [];
let bewerbungen = JSON.parse(localStorage.getItem('bewerbungen')) || [];
let entbannungen = JSON.parse(localStorage.getItem('entbannungen')) || [];
let currentUser = null;

// ----------------- FACTORY -----------------
const createTeamMember = (name, role, pass, avatar='sunriserp.png', permissions={editApplications:true, editBans:true, assignRoles:true, deleteTeam:true}) => ({name, role, pass, avatar, permissions});
const createBewerbung = (art, discord, minecraft, email, position, text) => ({
  datum: new Date().toLocaleString(), art, discord, minecraft, email, position, text, notiz:'', status:'offen', bearbeiter:''
});
const createEntbannung = (minecraft, email, text) => ({
  datum: new Date().toLocaleString(), minecraft, email, text, notiz:'', status:'offen', bearbeiter:''
});

// Standard-Leitungskonto
if(!teamMembers.find(m => m.name === 'Leitung')){
  teamMembers.unshift(createTeamMember('Leitung','Leitung','Leitung123'));
  saveData();
}

// ----------------- NAVIGATION -----------------
function showSection(id){
  document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  window.location.hash = id;
}
if(window.location.hash) showSection(window.location.hash.substring(1));

// ----------------- RENDER -----------------
function renderTeam(){
  const tbody = document.querySelector('.team-table tbody');
  tbody.innerHTML = '';
  teamMembers.forEach(m => {
    tbody.innerHTML += `<tr><td><img src="${m.avatar}" class="avatar"></td><td>${m.name}</td><td>${m.role}</td></tr>`;
  });
}
function renderPanel(){
  const tbodyB = document.querySelector('.panel-bewerbungen tbody');
  tbodyB.innerHTML = '';
  bewerbungen.forEach((b,i)=>{
    tbodyB.innerHTML += `<tr>
      <td>${b.datum}</td><td>${b.art}</td><td>${b.discord}</td><td>${b.minecraft}</td><td>${b.email}</td>
      <td>${b.position||''}</td><td>${b.text}</td><td>${b.notiz}</td><td>${b.status}</td><td>${b.bearbeiter}</td>
      <td><button onclick="editBewerbung(${i})">Bearbeiten</button></td>
    </tr>`;
  });
  const tbodyE = document.querySelector('.panel-entbannungen tbody');
  tbodyE.innerHTML = '';
  entbannungen.forEach((b,i)=>{
    tbodyE.innerHTML += `<tr>
      <td>${b.datum}</td><td>${b.minecraft}</td><td>${b.email}</td><td>${b.text}</td>
      <td>${b.notiz}</td><td>${b.status}</td><td>${b.bearbeiter}</td>
      <td><button onclick="editEntbannung(${i})">Bearbeiten</button></td>
    </tr>`;
  });
  const tbodyT = document.querySelector('.team-accounts-table tbody');
  tbodyT.innerHTML = '';
  teamMembers.forEach(m=>{
    tbodyT.innerHTML += `<tr>
      <td>${m.name}</td><td>${m.role}</td><td><img src="${m.avatar}" class="avatar"></td>
      <td><button onclick="deleteTeam('${m.name}')">Löschen</button></td>
    </tr>`;
  });
}
function saveData(){
  localStorage.setItem('teamMembers',JSON.stringify(teamMembers));
  localStorage.setItem('bewerbungen',JSON.stringify(bewerbungen));
  localStorage.setItem('entbannungen',JSON.stringify(entbannungen));
  renderTeam();
  renderPanel();
}

// ----------------- PANEL LOGIC -----------------
document.querySelector('.login-form').onsubmit = e=>{
  e.preventDefault();
  const user = document.querySelector('.login-user').value;
  const pass = document.querySelector('.login-pass').value;
  const acc = teamMembers.find(m => m.name===user && m.pass===pass);
  if(acc){ currentUser=acc; alert('Erfolgreich angemeldet!'); document.querySelector('.panel-content').style.display='block'; renderPanel(); }
  else alert('Login fehlgeschlagen');
}

// ----------------- BEWERBUNG -----------------
document.querySelector('.bewerbung-form').onsubmit = e=>{
  e.preventDefault();
  const art = document.querySelector('.bewerbungs-art').value;
  const pos = document.querySelector('.bewerbung-position').value;
  const discord = document.querySelector('.bewerbung-discord').value;
  const minecraft = document.querySelector('.bewerbung-minecraft').value;
  const email = document.querySelector('.bewerbung-email').value;
  const text = document.querySelector('.bewerbung-text').value;
  bewerbungen.push(createBewerbung(art,discord,minecraft,email, art==='Teambewerbung'?pos:'' , text));
  saveData(); alert('Bewerbung abgeschickt!'); e.target.reset();
}

// ----------------- ENTBANNUNG -----------------
document.querySelector('.entbannung-form').onsubmit = e=>{
  e.preventDefault();
  const minecraft = document.querySelector('.entbannung-minecraft').value;
  const email = document.querySelector('.entbannung-email').value;
  const text = document.querySelector('.entbannung-text').value;
  entbannungen.push(createEntbannung(minecraft,email,text));
  saveData(); alert('Entbannungsantrag abgeschickt!'); e.target.reset();
}

// ----------------- TEAM CREATION -----------------
document.querySelector('.team-create-form').onsubmit = e=>{
  e.preventDefault();
  const name = document.querySelector('.team-name').value;
  const role = document.querySelector('.team-role').value;
  const pass = document.querySelector('.team-pass').value;
  const avatarFile = document.querySelector('.team-avatar').files[0];
  const perms = {
    editApplications: document.querySelector('.perm-apps').checked,
    editBans: document.querySelector('.perm-bans').checked,
    deleteTeam: document.querySelector('.perm-team').checked
  };
  if(avatarFile){
    const reader = new FileReader();
    reader.onload = ()=>{ teamMembers.push(createTeamMember(name,role,pass,reader.result,perms)); saveData(); e.target.reset(); document.getElementById('avatar-preview').src='sunriserp.png'; };
    reader.readAsDataURL(avatarFile);
  }else{
    teamMembers.push(createTeamMember(name,role,pass,'sunriserp.png',perms));
    saveData(); e.target.reset();
  }
}

// Avatar Vorschau
document.querySelector('.team-avatar').onchange = e=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = ()=>document.getElementById('avatar-preview').src=reader.result;
    reader.readAsDataURL(file);
  }
}

// ----------------- PANEL ACTIONS -----------------
function editBewerbung(i){
  if(!currentUser?.permissions.editApplications) return alert('Keine Berechtigung');
  const b = bewerbungen[i];
  const status = prompt('Status ändern (offen/gesehen/abgelehnt/angenommen):', b.status);
  if(status) b.status = status;
  const notiz = prompt('Notiz hinzufügen:', b.notiz);
  if(notiz!==null) b.notiz = notiz;
  b.bearbeiter = currentUser.name;
  saveData();
}

function editEntbannung(i){
  if(!currentUser?.permissions.editBans) return alert('Keine Berechtigung');
  const e = entbannungen[i];
  const status = prompt('Status ändern (offen/akzeptiert/abgelehnt):', e.status);
  if(status) e.status = status;
  const notiz = prompt('Notiz hinzufügen:', e.notiz);
  if(notiz!==null) e.notiz = notiz;
  e.bearbeiter = currentUser.name;
  saveData();
}

function deleteTeam(name){
  if(!currentUser?.permissions.deleteTeam) return alert('Keine Berechtigung');
  if(confirm(`Teammitglied ${name} löschen?`)){
    teamMembers = teamMembers.filter(m=>m.name!==name);
    saveData();
  }
}

function bulkBewerbungenSeen(){
  if(!currentUser?.permissions.editApplications) return alert('Keine Berechtigung');
  bewerbungen.forEach(b=>{ if(b.status==='offen') b.status='gesehen'; });
  saveData();
}

// ----------------- INIT -----------------
renderTeam();
renderPanel();
</script>

</body>
</html>
